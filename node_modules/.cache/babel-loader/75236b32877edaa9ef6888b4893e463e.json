{"ast":null,"code":"var _ = require(\"underscore\");\n\nexports.readNumberingXml = readNumberingXml;\nexports.Numbering = Numbering;\nexports.defaultNumbering = new Numbering({}, {});\n\nfunction Numbering(nums, abstractNums, styles) {\n  var allLevels = _.flatten(_.values(abstractNums).map(function (abstractNum) {\n    return _.values(abstractNum.levels);\n  }));\n\n  var levelsByParagraphStyleId = _.indexBy(allLevels.filter(function (level) {\n    return level.paragraphStyleId != null;\n  }), \"paragraphStyleId\");\n\n  function findLevel(numId, level) {\n    var num = nums[numId];\n\n    if (num) {\n      var abstractNum = abstractNums[num.abstractNumId];\n\n      if (!abstractNum) {\n        return null;\n      } else if (abstractNum.numStyleLink == null) {\n        return abstractNums[num.abstractNumId].levels[level];\n      } else {\n        var style = styles.findNumberingStyleById(abstractNum.numStyleLink);\n        return findLevel(style.numId, level);\n      }\n    } else {\n      return null;\n    }\n  }\n\n  function findLevelByParagraphStyleId(styleId) {\n    return levelsByParagraphStyleId[styleId] || null;\n  }\n\n  return {\n    findLevel: findLevel,\n    findLevelByParagraphStyleId: findLevelByParagraphStyleId\n  };\n}\n\nfunction readNumberingXml(root, options) {\n  if (!options || !options.styles) {\n    throw new Error(\"styles is missing\");\n  }\n\n  var abstractNums = readAbstractNums(root);\n  var nums = readNums(root, abstractNums);\n  return new Numbering(nums, abstractNums, options.styles);\n}\n\nfunction readAbstractNums(root) {\n  var abstractNums = {};\n  root.getElementsByTagName(\"w:abstractNum\").forEach(function (element) {\n    var id = element.attributes[\"w:abstractNumId\"];\n    abstractNums[id] = readAbstractNum(element);\n  });\n  return abstractNums;\n}\n\nfunction readAbstractNum(element) {\n  var levels = {};\n  element.getElementsByTagName(\"w:lvl\").forEach(function (levelElement) {\n    var levelIndex = levelElement.attributes[\"w:ilvl\"];\n    var numFmt = levelElement.first(\"w:numFmt\").attributes[\"w:val\"];\n    var paragraphStyleId = levelElement.firstOrEmpty(\"w:pStyle\").attributes[\"w:val\"];\n    levels[levelIndex] = {\n      isOrdered: numFmt !== \"bullet\",\n      level: levelIndex,\n      paragraphStyleId: paragraphStyleId\n    };\n  });\n  var numStyleLink = element.firstOrEmpty(\"w:numStyleLink\").attributes[\"w:val\"];\n  return {\n    levels: levels,\n    numStyleLink: numStyleLink\n  };\n}\n\nfunction readNums(root) {\n  var nums = {};\n  root.getElementsByTagName(\"w:num\").forEach(function (element) {\n    var numId = element.attributes[\"w:numId\"];\n    var abstractNumId = element.first(\"w:abstractNumId\").attributes[\"w:val\"];\n    nums[numId] = {\n      abstractNumId: abstractNumId\n    };\n  });\n  return nums;\n}","map":{"version":3,"names":["_","require","exports","readNumberingXml","Numbering","defaultNumbering","nums","abstractNums","styles","allLevels","flatten","values","map","abstractNum","levels","levelsByParagraphStyleId","indexBy","filter","level","paragraphStyleId","findLevel","numId","num","abstractNumId","numStyleLink","style","findNumberingStyleById","findLevelByParagraphStyleId","styleId","root","options","Error","readAbstractNums","readNums","getElementsByTagName","forEach","element","id","attributes","readAbstractNum","levelElement","levelIndex","numFmt","first","firstOrEmpty","isOrdered"],"sources":["E:/react-projects/new project/2022/converter/converter/node_modules/mammoth/lib/docx/numbering-xml.js"],"sourcesContent":["var _ = require(\"underscore\");\n\nexports.readNumberingXml = readNumberingXml;\nexports.Numbering = Numbering;\nexports.defaultNumbering = new Numbering({}, {});\n\nfunction Numbering(nums, abstractNums, styles) {\n    var allLevels = _.flatten(_.values(abstractNums).map(function(abstractNum) {\n        return _.values(abstractNum.levels);\n    }));\n\n    var levelsByParagraphStyleId = _.indexBy(\n        allLevels.filter(function(level) {\n            return level.paragraphStyleId != null;\n        }),\n        \"paragraphStyleId\"\n    );\n\n    function findLevel(numId, level) {\n        var num = nums[numId];\n        if (num) {\n            var abstractNum = abstractNums[num.abstractNumId];\n            if (!abstractNum) {\n                return null;\n            } else if (abstractNum.numStyleLink == null) {\n                return abstractNums[num.abstractNumId].levels[level];\n            } else {\n                var style = styles.findNumberingStyleById(abstractNum.numStyleLink);\n                return findLevel(style.numId, level);\n            }\n        } else {\n            return null;\n        }\n    }\n\n    function findLevelByParagraphStyleId(styleId) {\n        return levelsByParagraphStyleId[styleId] || null;\n    }\n\n    return {\n        findLevel: findLevel,\n        findLevelByParagraphStyleId: findLevelByParagraphStyleId\n    };\n}\n\nfunction readNumberingXml(root, options) {\n    if (!options || !options.styles) {\n        throw new Error(\"styles is missing\");\n    }\n\n    var abstractNums = readAbstractNums(root);\n    var nums = readNums(root, abstractNums);\n    return new Numbering(nums, abstractNums, options.styles);\n}\n\nfunction readAbstractNums(root) {\n    var abstractNums = {};\n    root.getElementsByTagName(\"w:abstractNum\").forEach(function(element) {\n        var id = element.attributes[\"w:abstractNumId\"];\n        abstractNums[id] = readAbstractNum(element);\n    });\n    return abstractNums;\n}\n\nfunction readAbstractNum(element) {\n    var levels = {};\n    element.getElementsByTagName(\"w:lvl\").forEach(function(levelElement) {\n        var levelIndex = levelElement.attributes[\"w:ilvl\"];\n        var numFmt = levelElement.first(\"w:numFmt\").attributes[\"w:val\"];\n        var paragraphStyleId = levelElement.firstOrEmpty(\"w:pStyle\").attributes[\"w:val\"];\n\n        levels[levelIndex] = {\n            isOrdered: numFmt !== \"bullet\",\n            level: levelIndex,\n            paragraphStyleId: paragraphStyleId\n        };\n    });\n\n    var numStyleLink = element.firstOrEmpty(\"w:numStyleLink\").attributes[\"w:val\"];\n\n    return {levels: levels, numStyleLink: numStyleLink};\n}\n\nfunction readNums(root) {\n    var nums = {};\n    root.getElementsByTagName(\"w:num\").forEach(function(element) {\n        var numId = element.attributes[\"w:numId\"];\n        var abstractNumId = element.first(\"w:abstractNumId\").attributes[\"w:val\"];\n        nums[numId] = {abstractNumId: abstractNumId};\n    });\n    return nums;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}