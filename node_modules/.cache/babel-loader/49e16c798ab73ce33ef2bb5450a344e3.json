{"ast":null,"code":"exports.createBodyReader = createBodyReader;\nexports._readNumberingProperties = readNumberingProperties;\n\nvar dingbatToUnicode = require(\"dingbat-to-unicode\");\n\nvar _ = require(\"underscore\");\n\nvar documents = require(\"../documents\");\n\nvar Result = require(\"../results\").Result;\n\nvar warning = require(\"../results\").warning;\n\nvar uris = require(\"./uris\");\n\nfunction createBodyReader(options) {\n  return {\n    readXmlElement: function (element) {\n      return new BodyReader(options).readXmlElement(element);\n    },\n    readXmlElements: function (elements) {\n      return new BodyReader(options).readXmlElements(elements);\n    }\n  };\n}\n\nfunction BodyReader(options) {\n  var complexFieldStack = [];\n  var currentInstrText = [];\n  var relationships = options.relationships;\n  var contentTypes = options.contentTypes;\n  var docxFile = options.docxFile;\n  var files = options.files;\n  var numbering = options.numbering;\n  var styles = options.styles;\n\n  function readXmlElements(elements) {\n    var results = elements.map(readXmlElement);\n    return combineResults(results);\n  }\n\n  function readXmlElement(element) {\n    if (element.type === \"element\") {\n      var handler = xmlElementReaders[element.name];\n\n      if (handler) {\n        return handler(element);\n      } else if (!Object.prototype.hasOwnProperty.call(ignoreElements, element.name)) {\n        var message = warning(\"An unrecognised element was ignored: \" + element.name);\n        return emptyResultWithMessages([message]);\n      }\n    }\n\n    return emptyResult();\n  }\n\n  function readParagraphIndent(element) {\n    return {\n      start: element.attributes[\"w:start\"] || element.attributes[\"w:left\"],\n      end: element.attributes[\"w:end\"] || element.attributes[\"w:right\"],\n      firstLine: element.attributes[\"w:firstLine\"],\n      hanging: element.attributes[\"w:hanging\"]\n    };\n  }\n\n  function readRunProperties(element) {\n    return readRunStyle(element).map(function (style) {\n      var fontSizeString = element.firstOrEmpty(\"w:sz\").attributes[\"w:val\"]; // w:sz gives the font size in half points, so halve the value to get the size in points\n\n      var fontSize = /^[0-9]+$/.test(fontSizeString) ? parseInt(fontSizeString, 10) / 2 : null;\n      return {\n        type: \"runProperties\",\n        styleId: style.styleId,\n        styleName: style.name,\n        verticalAlignment: element.firstOrEmpty(\"w:vertAlign\").attributes[\"w:val\"],\n        font: element.firstOrEmpty(\"w:rFonts\").attributes[\"w:ascii\"],\n        fontSize: fontSize,\n        isBold: readBooleanElement(element.first(\"w:b\")),\n        isUnderline: readUnderline(element.first(\"w:u\")),\n        isItalic: readBooleanElement(element.first(\"w:i\")),\n        isStrikethrough: readBooleanElement(element.first(\"w:strike\")),\n        isAllCaps: readBooleanElement(element.first(\"w:caps\")),\n        isSmallCaps: readBooleanElement(element.first(\"w:smallCaps\"))\n      };\n    });\n  }\n\n  function readUnderline(element) {\n    if (element) {\n      var value = element.attributes[\"w:val\"];\n      return value !== undefined && value !== \"false\" && value !== \"0\" && value !== \"none\";\n    } else {\n      return false;\n    }\n  }\n\n  function readBooleanElement(element) {\n    if (element) {\n      var value = element.attributes[\"w:val\"];\n      return value !== \"false\" && value !== \"0\";\n    } else {\n      return false;\n    }\n  }\n\n  function readParagraphStyle(element) {\n    return readStyle(element, \"w:pStyle\", \"Paragraph\", styles.findParagraphStyleById);\n  }\n\n  function readRunStyle(element) {\n    return readStyle(element, \"w:rStyle\", \"Run\", styles.findCharacterStyleById);\n  }\n\n  function readTableStyle(element) {\n    return readStyle(element, \"w:tblStyle\", \"Table\", styles.findTableStyleById);\n  }\n\n  function readStyle(element, styleTagName, styleType, findStyleById) {\n    var messages = [];\n    var styleElement = element.first(styleTagName);\n    var styleId = null;\n    var name = null;\n\n    if (styleElement) {\n      styleId = styleElement.attributes[\"w:val\"];\n\n      if (styleId) {\n        var style = findStyleById(styleId);\n\n        if (style) {\n          name = style.name;\n        } else {\n          messages.push(undefinedStyleWarning(styleType, styleId));\n        }\n      }\n    }\n\n    return elementResultWithMessages({\n      styleId: styleId,\n      name: name\n    }, messages);\n  }\n\n  var unknownComplexField = {\n    type: \"unknown\"\n  };\n\n  function readFldChar(element) {\n    var type = element.attributes[\"w:fldCharType\"];\n\n    if (type === \"begin\") {\n      complexFieldStack.push(unknownComplexField);\n      currentInstrText = [];\n    } else if (type === \"end\") {\n      complexFieldStack.pop();\n    } else if (type === \"separate\") {\n      var hyperlinkOptions = parseHyperlinkFieldCode(currentInstrText.join(''));\n      var complexField = hyperlinkOptions === null ? unknownComplexField : {\n        type: \"hyperlink\",\n        options: hyperlinkOptions\n      };\n      complexFieldStack.pop();\n      complexFieldStack.push(complexField);\n    }\n\n    return emptyResult();\n  }\n\n  function currentHyperlinkOptions() {\n    var topHyperlink = _.last(complexFieldStack.filter(function (complexField) {\n      return complexField.type === \"hyperlink\";\n    }));\n\n    return topHyperlink ? topHyperlink.options : null;\n  }\n\n  function parseHyperlinkFieldCode(code) {\n    var externalLinkResult = /\\s*HYPERLINK \"(.*)\"/.exec(code);\n\n    if (externalLinkResult) {\n      return {\n        href: externalLinkResult[1]\n      };\n    }\n\n    var internalLinkResult = /\\s*HYPERLINK\\s+\\\\l\\s+\"(.*)\"/.exec(code);\n\n    if (internalLinkResult) {\n      return {\n        anchor: internalLinkResult[1]\n      };\n    }\n\n    return null;\n  }\n\n  function readInstrText(element) {\n    currentInstrText.push(element.text());\n    return emptyResult();\n  }\n\n  function readSymbol(element) {\n    // See 17.3.3.30 sym (Symbol Character) of ECMA-376 4th edition Part 1\n    var font = element.attributes[\"w:font\"];\n    var char = element.attributes[\"w:char\"];\n    var unicodeCharacter = dingbatToUnicode.hex(font, char);\n\n    if (unicodeCharacter == null && /^F0..$/.test(char)) {\n      unicodeCharacter = dingbatToUnicode.hex(font, char.substring(2));\n    }\n\n    if (unicodeCharacter == null) {\n      return emptyResultWithMessages([warning(\"A w:sym element with an unsupported character was ignored: char \" + char + \" in font \" + font)]);\n    } else {\n      return elementResult(new documents.Text(unicodeCharacter.string));\n    }\n  }\n\n  function noteReferenceReader(noteType) {\n    return function (element) {\n      var noteId = element.attributes[\"w:id\"];\n      return elementResult(new documents.NoteReference({\n        noteType: noteType,\n        noteId: noteId\n      }));\n    };\n  }\n\n  function readCommentReference(element) {\n    return elementResult(documents.commentReference({\n      commentId: element.attributes[\"w:id\"]\n    }));\n  }\n\n  function readChildElements(element) {\n    return readXmlElements(element.children);\n  }\n\n  var xmlElementReaders = {\n    \"w:p\": function (element) {\n      return readXmlElements(element.children).map(function (children) {\n        var properties = _.find(children, isParagraphProperties);\n\n        return new documents.Paragraph(children.filter(negate(isParagraphProperties)), properties);\n      }).insertExtra();\n    },\n    \"w:pPr\": function (element) {\n      return readParagraphStyle(element).map(function (style) {\n        return {\n          type: \"paragraphProperties\",\n          styleId: style.styleId,\n          styleName: style.name,\n          alignment: element.firstOrEmpty(\"w:jc\").attributes[\"w:val\"],\n          numbering: readNumberingProperties(style.styleId, element.firstOrEmpty(\"w:numPr\"), numbering),\n          indent: readParagraphIndent(element.firstOrEmpty(\"w:ind\"))\n        };\n      });\n    },\n    \"w:r\": function (element) {\n      return readXmlElements(element.children).map(function (children) {\n        var properties = _.find(children, isRunProperties);\n\n        children = children.filter(negate(isRunProperties));\n        var hyperlinkOptions = currentHyperlinkOptions();\n\n        if (hyperlinkOptions !== null) {\n          children = [new documents.Hyperlink(children, hyperlinkOptions)];\n        }\n\n        return new documents.Run(children, properties);\n      });\n    },\n    \"w:rPr\": readRunProperties,\n    \"w:fldChar\": readFldChar,\n    \"w:instrText\": readInstrText,\n    \"w:t\": function (element) {\n      return elementResult(new documents.Text(element.text()));\n    },\n    \"w:tab\": function (element) {\n      return elementResult(new documents.Tab());\n    },\n    \"w:noBreakHyphen\": function () {\n      return elementResult(new documents.Text(\"\\u2011\"));\n    },\n    \"w:softHyphen\": function (element) {\n      return elementResult(new documents.Text(\"\\u00AD\"));\n    },\n    \"w:sym\": readSymbol,\n    \"w:hyperlink\": function (element) {\n      var relationshipId = element.attributes[\"r:id\"];\n      var anchor = element.attributes[\"w:anchor\"];\n      return readXmlElements(element.children).map(function (children) {\n        function create(options) {\n          var targetFrame = element.attributes[\"w:tgtFrame\"] || null;\n          return new documents.Hyperlink(children, _.extend({\n            targetFrame: targetFrame\n          }, options));\n        }\n\n        if (relationshipId) {\n          var href = relationships.findTargetByRelationshipId(relationshipId);\n\n          if (anchor) {\n            href = uris.replaceFragment(href, anchor);\n          }\n\n          return create({\n            href: href\n          });\n        } else if (anchor) {\n          return create({\n            anchor: anchor\n          });\n        } else {\n          return children;\n        }\n      });\n    },\n    \"w:tbl\": readTable,\n    \"w:tr\": readTableRow,\n    \"w:tc\": readTableCell,\n    \"w:footnoteReference\": noteReferenceReader(\"footnote\"),\n    \"w:endnoteReference\": noteReferenceReader(\"endnote\"),\n    \"w:commentReference\": readCommentReference,\n    \"w:br\": function (element) {\n      var breakType = element.attributes[\"w:type\"];\n\n      if (breakType == null || breakType === \"textWrapping\") {\n        return elementResult(documents.lineBreak);\n      } else if (breakType === \"page\") {\n        return elementResult(documents.pageBreak);\n      } else if (breakType === \"column\") {\n        return elementResult(documents.columnBreak);\n      } else {\n        return emptyResultWithMessages([warning(\"Unsupported break type: \" + breakType)]);\n      }\n    },\n    \"w:bookmarkStart\": function (element) {\n      var name = element.attributes[\"w:name\"];\n\n      if (name === \"_GoBack\") {\n        return emptyResult();\n      } else {\n        return elementResult(new documents.BookmarkStart({\n          name: name\n        }));\n      }\n    },\n    \"mc:AlternateContent\": function (element) {\n      return readChildElements(element.first(\"mc:Fallback\"));\n    },\n    \"w:sdt\": function (element) {\n      return readXmlElements(element.firstOrEmpty(\"w:sdtContent\").children);\n    },\n    \"w:ins\": readChildElements,\n    \"w:object\": readChildElements,\n    \"w:smartTag\": readChildElements,\n    \"w:drawing\": readChildElements,\n    \"w:pict\": function (element) {\n      return readChildElements(element).toExtra();\n    },\n    \"v:roundrect\": readChildElements,\n    \"v:shape\": readChildElements,\n    \"v:textbox\": readChildElements,\n    \"w:txbxContent\": readChildElements,\n    \"wp:inline\": readDrawingElement,\n    \"wp:anchor\": readDrawingElement,\n    \"v:imagedata\": readImageData,\n    \"v:group\": readChildElements,\n    \"v:rect\": readChildElements\n  };\n  return {\n    readXmlElement: readXmlElement,\n    readXmlElements: readXmlElements\n  };\n\n  function readTable(element) {\n    var propertiesResult = readTableProperties(element.firstOrEmpty(\"w:tblPr\"));\n    return readXmlElements(element.children).flatMap(calculateRowSpans).flatMap(function (children) {\n      return propertiesResult.map(function (properties) {\n        return documents.Table(children, properties);\n      });\n    });\n  }\n\n  function readTableProperties(element) {\n    return readTableStyle(element).map(function (style) {\n      return {\n        styleId: style.styleId,\n        styleName: style.name\n      };\n    });\n  }\n\n  function readTableRow(element) {\n    var properties = element.firstOrEmpty(\"w:trPr\");\n    var isHeader = !!properties.first(\"w:tblHeader\");\n    return readXmlElements(element.children).map(function (children) {\n      return documents.TableRow(children, {\n        isHeader: isHeader\n      });\n    });\n  }\n\n  function readTableCell(element) {\n    return readXmlElements(element.children).map(function (children) {\n      var properties = element.firstOrEmpty(\"w:tcPr\");\n      var gridSpan = properties.firstOrEmpty(\"w:gridSpan\").attributes[\"w:val\"];\n      var colSpan = gridSpan ? parseInt(gridSpan, 10) : 1;\n      var cell = documents.TableCell(children, {\n        colSpan: colSpan\n      });\n      cell._vMerge = readVMerge(properties);\n      return cell;\n    });\n  }\n\n  function readVMerge(properties) {\n    var element = properties.first(\"w:vMerge\");\n\n    if (element) {\n      var val = element.attributes[\"w:val\"];\n      return val === \"continue\" || !val;\n    } else {\n      return null;\n    }\n  }\n\n  function calculateRowSpans(rows) {\n    var unexpectedNonRows = _.any(rows, function (row) {\n      return row.type !== documents.types.tableRow;\n    });\n\n    if (unexpectedNonRows) {\n      return elementResultWithMessages(rows, [warning(\"unexpected non-row element in table, cell merging may be incorrect\")]);\n    }\n\n    var unexpectedNonCells = _.any(rows, function (row) {\n      return _.any(row.children, function (cell) {\n        return cell.type !== documents.types.tableCell;\n      });\n    });\n\n    if (unexpectedNonCells) {\n      return elementResultWithMessages(rows, [warning(\"unexpected non-cell element in table row, cell merging may be incorrect\")]);\n    }\n\n    var columns = {};\n    rows.forEach(function (row) {\n      var cellIndex = 0;\n      row.children.forEach(function (cell) {\n        if (cell._vMerge && columns[cellIndex]) {\n          columns[cellIndex].rowSpan++;\n        } else {\n          columns[cellIndex] = cell;\n          cell._vMerge = false;\n        }\n\n        cellIndex += cell.colSpan;\n      });\n    });\n    rows.forEach(function (row) {\n      row.children = row.children.filter(function (cell) {\n        return !cell._vMerge;\n      });\n      row.children.forEach(function (cell) {\n        delete cell._vMerge;\n      });\n    });\n    return elementResult(rows);\n  }\n\n  function readDrawingElement(element) {\n    var blips = element.getElementsByTagName(\"a:graphic\").getElementsByTagName(\"a:graphicData\").getElementsByTagName(\"pic:pic\").getElementsByTagName(\"pic:blipFill\").getElementsByTagName(\"a:blip\");\n    return combineResults(blips.map(readBlip.bind(null, element)));\n  }\n\n  function readBlip(element, blip) {\n    var properties = element.first(\"wp:docPr\").attributes;\n    var altText = isBlank(properties.descr) ? properties.title : properties.descr;\n    var blipImageFile = findBlipImageFile(blip);\n\n    if (blipImageFile === null) {\n      return emptyResultWithMessages([warning(\"Could not find image file for a:blip element\")]);\n    } else {\n      return readImage(blipImageFile, altText);\n    }\n  }\n\n  function isBlank(value) {\n    return value == null || /^\\s*$/.test(value);\n  }\n\n  function findBlipImageFile(blip) {\n    var embedRelationshipId = blip.attributes[\"r:embed\"];\n    var linkRelationshipId = blip.attributes[\"r:link\"];\n\n    if (embedRelationshipId) {\n      return findEmbeddedImageFile(embedRelationshipId);\n    } else if (linkRelationshipId) {\n      var imagePath = relationships.findTargetByRelationshipId(linkRelationshipId);\n      return {\n        path: imagePath,\n        read: files.read.bind(files, imagePath)\n      };\n    } else {\n      return null;\n    }\n  }\n\n  function readImageData(element) {\n    var relationshipId = element.attributes['r:id'];\n\n    if (relationshipId) {\n      return readImage(findEmbeddedImageFile(relationshipId), element.attributes[\"o:title\"]);\n    } else {\n      return emptyResultWithMessages([warning(\"A v:imagedata element without a relationship ID was ignored\")]);\n    }\n  }\n\n  function findEmbeddedImageFile(relationshipId) {\n    var path = uris.uriToZipEntryName(\"word\", relationships.findTargetByRelationshipId(relationshipId));\n    return {\n      path: path,\n      read: docxFile.read.bind(docxFile, path)\n    };\n  }\n\n  function readImage(imageFile, altText) {\n    var contentType = contentTypes.findContentType(imageFile.path);\n    var image = documents.Image({\n      readImage: imageFile.read,\n      altText: altText,\n      contentType: contentType\n    });\n    var warnings = supportedImageTypes[contentType] ? [] : warning(\"Image of type \" + contentType + \" is unlikely to display in web browsers\");\n    return elementResultWithMessages(image, warnings);\n  }\n\n  function undefinedStyleWarning(type, styleId) {\n    return warning(type + \" style with ID \" + styleId + \" was referenced but not defined in the document\");\n  }\n}\n\nfunction readNumberingProperties(styleId, element, numbering) {\n  if (styleId != null) {\n    var levelByStyleId = numbering.findLevelByParagraphStyleId(styleId);\n\n    if (levelByStyleId != null) {\n      return levelByStyleId;\n    }\n  }\n\n  var level = element.firstOrEmpty(\"w:ilvl\").attributes[\"w:val\"];\n  var numId = element.firstOrEmpty(\"w:numId\").attributes[\"w:val\"];\n\n  if (level === undefined || numId === undefined) {\n    return null;\n  } else {\n    return numbering.findLevel(numId, level);\n  }\n}\n\nvar supportedImageTypes = {\n  \"image/png\": true,\n  \"image/gif\": true,\n  \"image/jpeg\": true,\n  \"image/svg+xml\": true,\n  \"image/tiff\": true\n};\nvar ignoreElements = {\n  \"office-word:wrap\": true,\n  \"v:shadow\": true,\n  \"v:shapetype\": true,\n  \"w:annotationRef\": true,\n  \"w:bookmarkEnd\": true,\n  \"w:sectPr\": true,\n  \"w:proofErr\": true,\n  \"w:lastRenderedPageBreak\": true,\n  \"w:commentRangeStart\": true,\n  \"w:commentRangeEnd\": true,\n  \"w:del\": true,\n  \"w:footnoteRef\": true,\n  \"w:endnoteRef\": true,\n  \"w:tblPr\": true,\n  \"w:tblGrid\": true,\n  \"w:trPr\": true,\n  \"w:tcPr\": true\n};\n\nfunction isParagraphProperties(element) {\n  return element.type === \"paragraphProperties\";\n}\n\nfunction isRunProperties(element) {\n  return element.type === \"runProperties\";\n}\n\nfunction negate(predicate) {\n  return function (value) {\n    return !predicate(value);\n  };\n}\n\nfunction emptyResultWithMessages(messages) {\n  return new ReadResult(null, null, messages);\n}\n\nfunction emptyResult() {\n  return new ReadResult(null);\n}\n\nfunction elementResult(element) {\n  return new ReadResult(element);\n}\n\nfunction elementResultWithMessages(element, messages) {\n  return new ReadResult(element, null, messages);\n}\n\nfunction ReadResult(element, extra, messages) {\n  this.value = element || [];\n  this.extra = extra;\n  this._result = new Result({\n    element: this.value,\n    extra: extra\n  }, messages);\n  this.messages = this._result.messages;\n}\n\nReadResult.prototype.toExtra = function () {\n  return new ReadResult(null, joinElements(this.extra, this.value), this.messages);\n};\n\nReadResult.prototype.insertExtra = function () {\n  var extra = this.extra;\n\n  if (extra && extra.length) {\n    return new ReadResult(joinElements(this.value, extra), null, this.messages);\n  } else {\n    return this;\n  }\n};\n\nReadResult.prototype.map = function (func) {\n  var result = this._result.map(function (value) {\n    return func(value.element);\n  });\n\n  return new ReadResult(result.value, this.extra, result.messages);\n};\n\nReadResult.prototype.flatMap = function (func) {\n  var result = this._result.flatMap(function (value) {\n    return func(value.element)._result;\n  });\n\n  return new ReadResult(result.value.element, joinElements(this.extra, result.value.extra), result.messages);\n};\n\nfunction combineResults(results) {\n  var result = Result.combine(_.pluck(results, \"_result\"));\n  return new ReadResult(_.flatten(_.pluck(result.value, \"element\")), _.filter(_.flatten(_.pluck(result.value, \"extra\")), identity), result.messages);\n}\n\nfunction joinElements(first, second) {\n  return _.flatten([first, second]);\n}\n\nfunction identity(value) {\n  return value;\n}","map":{"version":3,"names":["exports","createBodyReader","_readNumberingProperties","readNumberingProperties","dingbatToUnicode","require","_","documents","Result","warning","uris","options","readXmlElement","element","BodyReader","readXmlElements","elements","complexFieldStack","currentInstrText","relationships","contentTypes","docxFile","files","numbering","styles","results","map","combineResults","type","handler","xmlElementReaders","name","Object","prototype","hasOwnProperty","call","ignoreElements","message","emptyResultWithMessages","emptyResult","readParagraphIndent","start","attributes","end","firstLine","hanging","readRunProperties","readRunStyle","style","fontSizeString","firstOrEmpty","fontSize","test","parseInt","styleId","styleName","verticalAlignment","font","isBold","readBooleanElement","first","isUnderline","readUnderline","isItalic","isStrikethrough","isAllCaps","isSmallCaps","value","undefined","readParagraphStyle","readStyle","findParagraphStyleById","findCharacterStyleById","readTableStyle","findTableStyleById","styleTagName","styleType","findStyleById","messages","styleElement","push","undefinedStyleWarning","elementResultWithMessages","unknownComplexField","readFldChar","pop","hyperlinkOptions","parseHyperlinkFieldCode","join","complexField","currentHyperlinkOptions","topHyperlink","last","filter","code","externalLinkResult","exec","href","internalLinkResult","anchor","readInstrText","text","readSymbol","char","unicodeCharacter","hex","substring","elementResult","Text","string","noteReferenceReader","noteType","noteId","NoteReference","readCommentReference","commentReference","commentId","readChildElements","children","properties","find","isParagraphProperties","Paragraph","negate","insertExtra","alignment","indent","isRunProperties","Hyperlink","Run","Tab","relationshipId","create","targetFrame","extend","findTargetByRelationshipId","replaceFragment","readTable","readTableRow","readTableCell","breakType","lineBreak","pageBreak","columnBreak","BookmarkStart","toExtra","readDrawingElement","readImageData","propertiesResult","readTableProperties","flatMap","calculateRowSpans","Table","isHeader","TableRow","gridSpan","colSpan","cell","TableCell","_vMerge","readVMerge","val","rows","unexpectedNonRows","any","row","types","tableRow","unexpectedNonCells","tableCell","columns","forEach","cellIndex","rowSpan","blips","getElementsByTagName","readBlip","bind","blip","altText","isBlank","descr","title","blipImageFile","findBlipImageFile","readImage","embedRelationshipId","linkRelationshipId","findEmbeddedImageFile","imagePath","path","read","uriToZipEntryName","imageFile","contentType","findContentType","image","Image","warnings","supportedImageTypes","levelByStyleId","findLevelByParagraphStyleId","level","numId","findLevel","predicate","ReadResult","extra","_result","joinElements","length","func","result","combine","pluck","flatten","identity","second"],"sources":["E:/react-projects/new project/2022/converter/converter/node_modules/mammoth/lib/docx/body-reader.js"],"sourcesContent":["exports.createBodyReader = createBodyReader;\nexports._readNumberingProperties = readNumberingProperties;\n\nvar dingbatToUnicode = require(\"dingbat-to-unicode\");\nvar _ = require(\"underscore\");\n\nvar documents = require(\"../documents\");\nvar Result = require(\"../results\").Result;\nvar warning = require(\"../results\").warning;\nvar uris = require(\"./uris\");\n\nfunction createBodyReader(options) {\n    return {\n        readXmlElement: function(element) {\n            return new BodyReader(options).readXmlElement(element);\n        },\n        readXmlElements: function(elements) {\n            return new BodyReader(options).readXmlElements(elements);\n        }\n    };\n}\n\nfunction BodyReader(options) {\n    var complexFieldStack = [];\n    var currentInstrText = [];\n    var relationships = options.relationships;\n    var contentTypes = options.contentTypes;\n    var docxFile = options.docxFile;\n    var files = options.files;\n    var numbering = options.numbering;\n    var styles = options.styles;\n\n    function readXmlElements(elements) {\n        var results = elements.map(readXmlElement);\n        return combineResults(results);\n    }\n\n    function readXmlElement(element) {\n        if (element.type === \"element\") {\n            var handler = xmlElementReaders[element.name];\n            if (handler) {\n                return handler(element);\n            } else if (!Object.prototype.hasOwnProperty.call(ignoreElements, element.name)) {\n                var message = warning(\"An unrecognised element was ignored: \" + element.name);\n                return emptyResultWithMessages([message]);\n            }\n        }\n        return emptyResult();\n    }\n\n    function readParagraphIndent(element) {\n        return {\n            start: element.attributes[\"w:start\"] || element.attributes[\"w:left\"],\n            end: element.attributes[\"w:end\"] || element.attributes[\"w:right\"],\n            firstLine: element.attributes[\"w:firstLine\"],\n            hanging: element.attributes[\"w:hanging\"]\n        };\n    }\n\n    function readRunProperties(element) {\n        return readRunStyle(element).map(function(style) {\n            var fontSizeString = element.firstOrEmpty(\"w:sz\").attributes[\"w:val\"];\n            // w:sz gives the font size in half points, so halve the value to get the size in points\n            var fontSize = /^[0-9]+$/.test(fontSizeString) ? parseInt(fontSizeString, 10) / 2 : null;\n\n            return {\n                type: \"runProperties\",\n                styleId: style.styleId,\n                styleName: style.name,\n                verticalAlignment: element.firstOrEmpty(\"w:vertAlign\").attributes[\"w:val\"],\n                font: element.firstOrEmpty(\"w:rFonts\").attributes[\"w:ascii\"],\n                fontSize: fontSize,\n                isBold: readBooleanElement(element.first(\"w:b\")),\n                isUnderline: readUnderline(element.first(\"w:u\")),\n                isItalic: readBooleanElement(element.first(\"w:i\")),\n                isStrikethrough: readBooleanElement(element.first(\"w:strike\")),\n                isAllCaps: readBooleanElement(element.first(\"w:caps\")),\n                isSmallCaps: readBooleanElement(element.first(\"w:smallCaps\"))\n            };\n        });\n    }\n\n    function readUnderline(element) {\n        if (element) {\n            var value = element.attributes[\"w:val\"];\n            return value !== undefined && value !== \"false\" && value !== \"0\" && value !== \"none\";\n        } else {\n            return false;\n        }\n    }\n\n    function readBooleanElement(element) {\n        if (element) {\n            var value = element.attributes[\"w:val\"];\n            return value !== \"false\" && value !== \"0\";\n        } else {\n            return false;\n        }\n    }\n\n    function readParagraphStyle(element) {\n        return readStyle(element, \"w:pStyle\", \"Paragraph\", styles.findParagraphStyleById);\n    }\n\n    function readRunStyle(element) {\n        return readStyle(element, \"w:rStyle\", \"Run\", styles.findCharacterStyleById);\n    }\n\n    function readTableStyle(element) {\n        return readStyle(element, \"w:tblStyle\", \"Table\", styles.findTableStyleById);\n    }\n\n    function readStyle(element, styleTagName, styleType, findStyleById) {\n        var messages = [];\n        var styleElement = element.first(styleTagName);\n        var styleId = null;\n        var name = null;\n        if (styleElement) {\n            styleId = styleElement.attributes[\"w:val\"];\n            if (styleId) {\n                var style = findStyleById(styleId);\n                if (style) {\n                    name = style.name;\n                } else {\n                    messages.push(undefinedStyleWarning(styleType, styleId));\n                }\n            }\n        }\n        return elementResultWithMessages({styleId: styleId, name: name}, messages);\n    }\n\n    var unknownComplexField = {type: \"unknown\"};\n\n    function readFldChar(element) {\n        var type = element.attributes[\"w:fldCharType\"];\n        if (type === \"begin\") {\n            complexFieldStack.push(unknownComplexField);\n            currentInstrText = [];\n        } else if (type === \"end\") {\n            complexFieldStack.pop();\n        } else if (type === \"separate\") {\n            var hyperlinkOptions = parseHyperlinkFieldCode(currentInstrText.join(''));\n            var complexField = hyperlinkOptions === null ? unknownComplexField : {type: \"hyperlink\", options: hyperlinkOptions};\n            complexFieldStack.pop();\n            complexFieldStack.push(complexField);\n        }\n        return emptyResult();\n    }\n\n    function currentHyperlinkOptions() {\n        var topHyperlink = _.last(complexFieldStack.filter(function(complexField) {\n            return complexField.type === \"hyperlink\";\n        }));\n        return topHyperlink ? topHyperlink.options : null;\n    }\n\n    function parseHyperlinkFieldCode(code) {\n        var externalLinkResult = /\\s*HYPERLINK \"(.*)\"/.exec(code);\n        if (externalLinkResult) {\n            return {href: externalLinkResult[1]};\n        }\n\n        var internalLinkResult = /\\s*HYPERLINK\\s+\\\\l\\s+\"(.*)\"/.exec(code);\n        if (internalLinkResult) {\n            return {anchor: internalLinkResult[1]};\n        }\n\n        return null;\n    }\n\n    function readInstrText(element) {\n        currentInstrText.push(element.text());\n        return emptyResult();\n    }\n\n    function readSymbol(element) {\n        // See 17.3.3.30 sym (Symbol Character) of ECMA-376 4th edition Part 1\n        var font = element.attributes[\"w:font\"];\n        var char = element.attributes[\"w:char\"];\n        var unicodeCharacter = dingbatToUnicode.hex(font, char);\n        if (unicodeCharacter == null && /^F0..$/.test(char)) {\n            unicodeCharacter = dingbatToUnicode.hex(font, char.substring(2));\n        }\n\n        if (unicodeCharacter == null) {\n            return emptyResultWithMessages([warning(\n                \"A w:sym element with an unsupported character was ignored: char \" +  char + \" in font \" + font\n            )]);\n        } else {\n            return elementResult(new documents.Text(unicodeCharacter.string));\n        }\n    }\n\n    function noteReferenceReader(noteType) {\n        return function(element) {\n            var noteId = element.attributes[\"w:id\"];\n            return elementResult(new documents.NoteReference({\n                noteType: noteType,\n                noteId: noteId\n            }));\n        };\n    }\n\n    function readCommentReference(element) {\n        return elementResult(documents.commentReference({\n            commentId: element.attributes[\"w:id\"]\n        }));\n    }\n\n    function readChildElements(element) {\n        return readXmlElements(element.children);\n    }\n\n    var xmlElementReaders = {\n        \"w:p\": function(element) {\n            return readXmlElements(element.children)\n                .map(function(children) {\n                    var properties = _.find(children, isParagraphProperties);\n                    return new documents.Paragraph(\n                        children.filter(negate(isParagraphProperties)),\n                        properties\n                    );\n                })\n                .insertExtra();\n        },\n        \"w:pPr\": function(element) {\n            return readParagraphStyle(element).map(function(style) {\n                return {\n                    type: \"paragraphProperties\",\n                    styleId: style.styleId,\n                    styleName: style.name,\n                    alignment: element.firstOrEmpty(\"w:jc\").attributes[\"w:val\"],\n                    numbering: readNumberingProperties(style.styleId, element.firstOrEmpty(\"w:numPr\"), numbering),\n                    indent: readParagraphIndent(element.firstOrEmpty(\"w:ind\"))\n                };\n            });\n        },\n        \"w:r\": function(element) {\n            return readXmlElements(element.children)\n                .map(function(children) {\n                    var properties = _.find(children, isRunProperties);\n                    children = children.filter(negate(isRunProperties));\n\n                    var hyperlinkOptions = currentHyperlinkOptions();\n                    if (hyperlinkOptions !== null) {\n                        children = [new documents.Hyperlink(children, hyperlinkOptions)];\n                    }\n\n                    return new documents.Run(children, properties);\n                });\n        },\n        \"w:rPr\": readRunProperties,\n        \"w:fldChar\": readFldChar,\n        \"w:instrText\": readInstrText,\n        \"w:t\": function(element) {\n            return elementResult(new documents.Text(element.text()));\n        },\n        \"w:tab\": function(element) {\n            return elementResult(new documents.Tab());\n        },\n        \"w:noBreakHyphen\": function() {\n            return elementResult(new documents.Text(\"\\u2011\"));\n        },\n        \"w:softHyphen\": function(element) {\n            return elementResult(new documents.Text(\"\\u00AD\"));\n        },\n        \"w:sym\": readSymbol,\n        \"w:hyperlink\": function(element) {\n            var relationshipId = element.attributes[\"r:id\"];\n            var anchor = element.attributes[\"w:anchor\"];\n            return readXmlElements(element.children).map(function(children) {\n                function create(options) {\n                    var targetFrame = element.attributes[\"w:tgtFrame\"] || null;\n\n                    return new documents.Hyperlink(\n                        children,\n                        _.extend({targetFrame: targetFrame}, options)\n                    );\n                }\n\n                if (relationshipId) {\n                    var href = relationships.findTargetByRelationshipId(relationshipId);\n                    if (anchor) {\n                        href = uris.replaceFragment(href, anchor);\n                    }\n                    return create({href: href});\n                } else if (anchor) {\n                    return create({anchor: anchor});\n                } else {\n                    return children;\n                }\n            });\n        },\n        \"w:tbl\": readTable,\n        \"w:tr\": readTableRow,\n        \"w:tc\": readTableCell,\n        \"w:footnoteReference\": noteReferenceReader(\"footnote\"),\n        \"w:endnoteReference\": noteReferenceReader(\"endnote\"),\n        \"w:commentReference\": readCommentReference,\n        \"w:br\": function(element) {\n            var breakType = element.attributes[\"w:type\"];\n            if (breakType == null || breakType === \"textWrapping\") {\n                return elementResult(documents.lineBreak);\n            } else if (breakType === \"page\") {\n                return elementResult(documents.pageBreak);\n            } else if (breakType === \"column\") {\n                return elementResult(documents.columnBreak);\n            } else {\n                return emptyResultWithMessages([warning(\"Unsupported break type: \" + breakType)]);\n            }\n        },\n        \"w:bookmarkStart\": function(element){\n            var name = element.attributes[\"w:name\"];\n            if (name === \"_GoBack\") {\n                return emptyResult();\n            } else {\n                return elementResult(new documents.BookmarkStart({name: name}));\n            }\n        },\n\n        \"mc:AlternateContent\": function(element) {\n            return readChildElements(element.first(\"mc:Fallback\"));\n        },\n\n        \"w:sdt\": function(element) {\n            return readXmlElements(element.firstOrEmpty(\"w:sdtContent\").children);\n        },\n\n        \"w:ins\": readChildElements,\n        \"w:object\": readChildElements,\n        \"w:smartTag\": readChildElements,\n        \"w:drawing\": readChildElements,\n        \"w:pict\": function(element) {\n            return readChildElements(element).toExtra();\n        },\n        \"v:roundrect\": readChildElements,\n        \"v:shape\": readChildElements,\n        \"v:textbox\": readChildElements,\n        \"w:txbxContent\": readChildElements,\n        \"wp:inline\": readDrawingElement,\n        \"wp:anchor\": readDrawingElement,\n        \"v:imagedata\": readImageData,\n        \"v:group\": readChildElements,\n        \"v:rect\": readChildElements\n    };\n\n    return {\n        readXmlElement: readXmlElement,\n        readXmlElements: readXmlElements\n    };\n\n\n    function readTable(element) {\n        var propertiesResult = readTableProperties(element.firstOrEmpty(\"w:tblPr\"));\n        return readXmlElements(element.children)\n            .flatMap(calculateRowSpans)\n            .flatMap(function(children) {\n                return propertiesResult.map(function(properties) {\n                    return documents.Table(children, properties);\n                });\n            });\n    }\n\n    function readTableProperties(element) {\n        return readTableStyle(element).map(function(style) {\n            return {\n                styleId: style.styleId,\n                styleName: style.name\n            };\n        });\n    }\n\n    function readTableRow(element) {\n        var properties = element.firstOrEmpty(\"w:trPr\");\n        var isHeader = !!properties.first(\"w:tblHeader\");\n        return readXmlElements(element.children).map(function(children) {\n            return documents.TableRow(children, {isHeader: isHeader});\n        });\n    }\n\n    function readTableCell(element) {\n        return readXmlElements(element.children).map(function(children) {\n            var properties = element.firstOrEmpty(\"w:tcPr\");\n\n            var gridSpan = properties.firstOrEmpty(\"w:gridSpan\").attributes[\"w:val\"];\n            var colSpan = gridSpan ? parseInt(gridSpan, 10) : 1;\n\n            var cell = documents.TableCell(children, {colSpan: colSpan});\n            cell._vMerge = readVMerge(properties);\n            return cell;\n        });\n    }\n\n    function readVMerge(properties) {\n        var element = properties.first(\"w:vMerge\");\n        if (element) {\n            var val = element.attributes[\"w:val\"];\n            return val === \"continue\" || !val;\n        } else {\n            return null;\n        }\n    }\n\n    function calculateRowSpans(rows) {\n        var unexpectedNonRows = _.any(rows, function(row) {\n            return row.type !== documents.types.tableRow;\n        });\n        if (unexpectedNonRows) {\n            return elementResultWithMessages(rows, [warning(\n                \"unexpected non-row element in table, cell merging may be incorrect\"\n            )]);\n        }\n        var unexpectedNonCells = _.any(rows, function(row) {\n            return _.any(row.children, function(cell) {\n                return cell.type !== documents.types.tableCell;\n            });\n        });\n        if (unexpectedNonCells) {\n            return elementResultWithMessages(rows, [warning(\n                \"unexpected non-cell element in table row, cell merging may be incorrect\"\n            )]);\n        }\n\n        var columns = {};\n\n        rows.forEach(function(row) {\n            var cellIndex = 0;\n            row.children.forEach(function(cell) {\n                if (cell._vMerge && columns[cellIndex]) {\n                    columns[cellIndex].rowSpan++;\n                } else {\n                    columns[cellIndex] = cell;\n                    cell._vMerge = false;\n                }\n                cellIndex += cell.colSpan;\n            });\n        });\n\n        rows.forEach(function(row) {\n            row.children = row.children.filter(function(cell) {\n                return !cell._vMerge;\n            });\n            row.children.forEach(function(cell) {\n                delete cell._vMerge;\n            });\n        });\n\n        return elementResult(rows);\n    }\n\n    function readDrawingElement(element) {\n        var blips = element\n            .getElementsByTagName(\"a:graphic\")\n            .getElementsByTagName(\"a:graphicData\")\n            .getElementsByTagName(\"pic:pic\")\n            .getElementsByTagName(\"pic:blipFill\")\n            .getElementsByTagName(\"a:blip\");\n\n        return combineResults(blips.map(readBlip.bind(null, element)));\n    }\n\n    function readBlip(element, blip) {\n        var properties = element.first(\"wp:docPr\").attributes;\n        var altText = isBlank(properties.descr) ? properties.title : properties.descr;\n        var blipImageFile = findBlipImageFile(blip);\n        if (blipImageFile === null) {\n            return emptyResultWithMessages([warning(\"Could not find image file for a:blip element\")]);\n        } else {\n            return readImage(blipImageFile, altText);\n        }\n    }\n\n    function isBlank(value) {\n        return value == null || /^\\s*$/.test(value);\n    }\n\n    function findBlipImageFile(blip) {\n        var embedRelationshipId = blip.attributes[\"r:embed\"];\n        var linkRelationshipId = blip.attributes[\"r:link\"];\n        if (embedRelationshipId) {\n            return findEmbeddedImageFile(embedRelationshipId);\n        } else if (linkRelationshipId) {\n            var imagePath = relationships.findTargetByRelationshipId(linkRelationshipId);\n            return {\n                path: imagePath,\n                read: files.read.bind(files, imagePath)\n            };\n        } else {\n            return null;\n        }\n    }\n\n    function readImageData(element) {\n        var relationshipId = element.attributes['r:id'];\n\n        if (relationshipId) {\n            return readImage(\n                findEmbeddedImageFile(relationshipId),\n                element.attributes[\"o:title\"]);\n        } else {\n            return emptyResultWithMessages([warning(\"A v:imagedata element without a relationship ID was ignored\")]);\n        }\n    }\n\n    function findEmbeddedImageFile(relationshipId) {\n        var path = uris.uriToZipEntryName(\"word\", relationships.findTargetByRelationshipId(relationshipId));\n        return {\n            path: path,\n            read: docxFile.read.bind(docxFile, path)\n        };\n    }\n\n    function readImage(imageFile, altText) {\n        var contentType = contentTypes.findContentType(imageFile.path);\n\n        var image = documents.Image({\n            readImage: imageFile.read,\n            altText: altText,\n            contentType: contentType\n        });\n        var warnings = supportedImageTypes[contentType] ?\n            [] : warning(\"Image of type \" + contentType + \" is unlikely to display in web browsers\");\n        return elementResultWithMessages(image, warnings);\n    }\n\n    function undefinedStyleWarning(type, styleId) {\n        return warning(\n            type + \" style with ID \" + styleId + \" was referenced but not defined in the document\");\n    }\n}\n\n\nfunction readNumberingProperties(styleId, element, numbering) {\n    if (styleId != null) {\n        var levelByStyleId = numbering.findLevelByParagraphStyleId(styleId);\n        if (levelByStyleId != null) {\n            return levelByStyleId;\n        }\n    }\n\n    var level = element.firstOrEmpty(\"w:ilvl\").attributes[\"w:val\"];\n    var numId = element.firstOrEmpty(\"w:numId\").attributes[\"w:val\"];\n    if (level === undefined || numId === undefined) {\n        return null;\n    } else {\n        return numbering.findLevel(numId, level);\n    }\n}\n\nvar supportedImageTypes = {\n    \"image/png\": true,\n    \"image/gif\": true,\n    \"image/jpeg\": true,\n    \"image/svg+xml\": true,\n    \"image/tiff\": true\n};\n\nvar ignoreElements = {\n    \"office-word:wrap\": true,\n    \"v:shadow\": true,\n    \"v:shapetype\": true,\n    \"w:annotationRef\": true,\n    \"w:bookmarkEnd\": true,\n    \"w:sectPr\": true,\n    \"w:proofErr\": true,\n    \"w:lastRenderedPageBreak\": true,\n    \"w:commentRangeStart\": true,\n    \"w:commentRangeEnd\": true,\n    \"w:del\": true,\n    \"w:footnoteRef\": true,\n    \"w:endnoteRef\": true,\n    \"w:tblPr\": true,\n    \"w:tblGrid\": true,\n    \"w:trPr\": true,\n    \"w:tcPr\": true\n};\n\nfunction isParagraphProperties(element) {\n    return element.type === \"paragraphProperties\";\n}\n\nfunction isRunProperties(element) {\n    return element.type === \"runProperties\";\n}\n\nfunction negate(predicate) {\n    return function(value) {\n        return !predicate(value);\n    };\n}\n\n\nfunction emptyResultWithMessages(messages) {\n    return new ReadResult(null, null, messages);\n}\n\nfunction emptyResult() {\n    return new ReadResult(null);\n}\n\nfunction elementResult(element) {\n    return new ReadResult(element);\n}\n\nfunction elementResultWithMessages(element, messages) {\n    return new ReadResult(element, null, messages);\n}\n\nfunction ReadResult(element, extra, messages) {\n    this.value = element || [];\n    this.extra = extra;\n    this._result = new Result({\n        element: this.value,\n        extra: extra\n    }, messages);\n    this.messages = this._result.messages;\n}\n\nReadResult.prototype.toExtra = function() {\n    return new ReadResult(null, joinElements(this.extra, this.value), this.messages);\n};\n\nReadResult.prototype.insertExtra = function() {\n    var extra = this.extra;\n    if (extra && extra.length) {\n        return new ReadResult(joinElements(this.value, extra), null, this.messages);\n    } else {\n        return this;\n    }\n};\n\nReadResult.prototype.map = function(func) {\n    var result = this._result.map(function(value) {\n        return func(value.element);\n    });\n    return new ReadResult(result.value, this.extra, result.messages);\n};\n\nReadResult.prototype.flatMap = function(func) {\n    var result = this._result.flatMap(function(value) {\n        return func(value.element)._result;\n    });\n    return new ReadResult(result.value.element, joinElements(this.extra, result.value.extra), result.messages);\n};\n\nfunction combineResults(results) {\n    var result = Result.combine(_.pluck(results, \"_result\"));\n    return new ReadResult(\n        _.flatten(_.pluck(result.value, \"element\")),\n        _.filter(_.flatten(_.pluck(result.value, \"extra\")), identity),\n        result.messages\n    );\n}\n\nfunction joinElements(first, second) {\n    return _.flatten([first, second]);\n}\n\nfunction identity(value) {\n    return value;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}